<?php

namespace AppBundle\Controller;

use Application\Sonata\UserBundle\Entity\Schedule;
use Sonata\AdminBundle\Controller\CRUDController as Controller;
use Symfony\Component\HttpFoundation\Response;
use Application\Sonata\UserBundle\Entity\TimeInterval;
class ScheduleController extends Controller
{
    public function render($view, array $parameters = array(), Response $response = null)
    {

        if ($parameters['action'] === 'list'){
            $em = $this->getDoctrine()->getManager();

            $teachers = $em->getRepository('ApplicationSonataUserBundle:Schedule')->getDistinctTeachers();
            $parameters['teachers'] = $teachers;

            $groups = $em->getRepository('ApplicationSonataUserBundle:Schedule')->getDistinctGroups();
            $parameters['groups'] = $groups;

            $classrooms = $em->getRepository('ApplicationSonataUserBundle:Schedule')->getDistinctClassrooms();
            $parameters['classrooms'] = $classrooms;

            $timeIntervals = $em->getRepository('ApplicationSonataUserBundle:TimeInterval')->findAll();
            $parameters['timeintervals'] = $timeIntervals;

            $parameters['scheduleKeysArray'] = $em->getRepository('ApplicationSonataUserBundle:Schedule')->scheduleKeysArray();

            $weekdays = [
               '1' => 'Понедельник' ,
               '2' => 'Вторник' ,
               '3' => 'Среда' ,
               '4' => 'Четверг' ,
               '5' => 'Пятница' ,
               '6' => 'Суббота',
               '0' => 'Воскресенье'
            ];
            $parameters['weekdays'] = $weekdays;
            dump($parameters);
        }

        return parent::render($view, $parameters, $response); // TODO: Change the autogenerated stub
    }
}